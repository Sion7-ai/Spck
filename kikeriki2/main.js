document.addEventListener('DOMContentLoaded',function(){const e=document.getElementById('preloader'),t=document.body;if("undefined"==typeof gsap||"undefined"==typeof ScrollTrigger||"undefined"==typeof ScrollToPlugin){console.error("GSAP oder eines seiner Plugins konnte nicht geladen werden."),e&&(e.classList.add("loaded"),e.addEventListener("transitionend",()=>{e&& (e.style.display="none")},{once:!0}),console.log("Preloader fallback: GSAP not loaded, hiding preloader via CSS class.")),t&&t.classList.remove("preloading");const o=document.getElementById("mobile-menu-toggle"),n=document.getElementById("mobile-menu");return void(o&&n&&o.addEventListener("click",()=>{const e=n.classList.toggle("open-no-gsap");document.body.classList.toggle("no-scroll",e),o.setAttribute("aria-expanded",e)}))}gsap.registerPlugin(ScrollTrigger,ScrollToPlugin),e&&setTimeout(()=>{gsap.to(e,{autoAlpha:0,duration:.6,ease:"power2.out",onComplete:()=>{e&&(e.style.display="none"),t&&t.classList.remove("preloading"),console.log("Preloader normal fade: GSAP loaded, preloader hidden via GSAP."),ScrollTrigger.refresh()}})},1600);const o=document.getElementById("header"),n=document.getElementById("mobile-menu-toggle"),i=document.getElementById("mobile-menu"),r=document.querySelectorAll(".nav-item, .mobile-nav-item"),a=document.querySelectorAll(".page-section");let s=0;ScrollTrigger.create({trigger:"body",start:"top top",end:"bottom bottom",onUpdate:e=>{const t=e.scrollY;t>100?o.classList.add("scrolled"):o.classList.remove("scrolled");const n=document.querySelector(".hero-slide.active");if(n){const e=n.dataset.slideTheme||"dark",i=document.getElementById("hero");let r= .5*window.innerHeight;i.getBoundingClientRect().bottom>r?o.classList.toggle("light-theme","light"===e):o.classList.contains("scrolled")||o.classList.remove("light-theme")}else t<100&&o.classList.remove("light-theme")}}),n&&i&&(()=>{const e=i.querySelectorAll(".mobile-nav-item"),t=gsap.timeline({paused:!0,reversed:!0});t.to(i,{autoAlpha:1,y:"0%",duration:.5,ease:"power3.inOut"}).fromTo(e,{autoAlpha:0,y:30},{autoAlpha:1,y:0,stagger:.07,duration:.4,ease:"power2.out"},"-=.2"),n.addEventListener("click",()=>{const e="false"===n.getAttribute("aria-expanded");n.setAttribute("aria-expanded",e),body.classList.toggle("no-scroll",e),i.classList.toggle("open",e),e?t.play():t.reverse()})})();function l(e){const t=document.querySelector(e);if(t){let r=o.offsetHeight;"#hero"===e?r=0:ScrollTrigger.isInViewport(t,-r),gsap.to(window,{duration:1.5,scrollTo:{y:t,offsetY:r},ease:"power4.inOut"}),"true"===n.getAttribute("aria-expanded")&&setTimeout(()=>{n.click()},100)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),l(this.getAttribute("href"))})});function c(e){r.forEach(t=>{t.classList.toggle("active-link",t.dataset.section===e)})}if(a.length>0&&r.length>0&&(a.forEach(e=>{ScrollTrigger.create({trigger:e,start:()=>`top ${o.offsetHeight+.35*window.innerHeight}px`,end:()=>`bottom ${o.offsetHeight+.35*window.innerHeight}px`,onToggle:t=>{t.isActive&&c(e.id)},onEnterBack:()=>c(e.id)})}),setTimeout(()=>{let e=null;for(let t of a)if(ScrollTrigger.isInViewport(t,-.4)){e=t.id;break}e?c(e):a.length>0&&window.scrollY<a[0].offsetTop+.5*a[0].offsetHeight&&"hero"===a[0].id&&c("hero")},200)),window.location.hash?c(window.location.hash.substring(1)):a.length>0&&ScrollTrigger.isInViewport(a[0],-.5)&&"hero"===a[0].id&&c("hero"),document.querySelector(".hero-slider-wrapper")){const e=gsap.utils.toArray(".hero-slide",heroSlider),t=document.querySelectorAll(".hero-slider-arrow"),d=document.querySelector(".hero-slider-dots");letu=0,m,p=!1;if(e.length>0){e.forEach((t,o)=>{const n=document.createElement("span");n.classList.add("dot"),n.dataset.slide=o,0===o&&n.classList.add("active"),n.addEventListener("click",()=>{p||f(o)}),d&&d.appendChild(n)});const g=gsap.utils.toArray(".hero-slider-dots .dot");function h(t){p=!0;const n=gsap.timeline({onComplete:()=>p=!1}),i=t.querySelector(".hero-image-bg"),r=t.querySelectorAll(".animate-hero-item");return gsap.set(t,{autoAlpha:1}),n.fromTo(i,{scale:1.15,autoAlpha:0},{scale:1,autoAlpha:.8,duration:1.4,ease:"power3.out"}),n.fromTo(r,{autoAlpha:0,y:40,skewY:2},{autoAlpha:1,y:0,skewY:0,stagger:.1,duration:.8,ease:"power3.out"},"-=1.0"),n}function f(n,i="next"){if(n===u&&e[n].classList.contains("active")||p)return;p=!0;const r=e[u],a=e[n];clearInterval(m);const s=function(e){p=!0;const t=gsap.timeline({onComplete:()=>p=!1}),n=e.querySelector(".hero-image-bg"),i=e.querySelectorAll(".animate-hero-item");return t.to(i,{autoAlpha:0,y:-30,stagger:.05,duration:.5,ease:"power2.in"}).to(n,{autoAlpha:0,scale:1.05,duration:.7,ease:"power2.in"},"=-.4").set(e,{autoAlpha:0}),t}(r);s.eventCallback("onComplete",()=>{r.classList.remove("active"),a.classList.add("active"),h(a).eventCallback("onComplete",()=>{p=!1,y()}),g.forEach((e,t)=>e.classList.toggle("active",t===n)),u=n;const e=a.dataset.slideTheme||"dark";o.classList.toggle("light-theme","light"===e)})};function y(){clearInterval(m),m=setInterval(()=>{p||f((u+1)%e.length,"next")},7e3)}gsap.set(e,{autoAlpha:0}),e[0].classList.add("active"),h(e[0]).eventCallback("onComplete",()=>{p=!1,y()}),o.classList.toggle("light-theme","light"===e[0].dataset.slideTheme),t.forEach(t=>{t.addEventListener("click",()=>{if(p)return;let o;"next"===t.classList[1]?o=(u+1)%e.length:o=(u-1+e.length)%e.length,f(o)})})}}const y=document.querySelector(".marquee-content");y&&y.children.length>0&&gsap.to(y,{x:-y.scrollWidth/2,duration:30,ease:"none",repeat:-1}),document.querySelector(".problem-solution-container")&&document.querySelector(".sticky-title-column")&&document.querySelector(".scrollable-content-column")&&ScrollTrigger.create({trigger:".problem-solution-container",pin:".sticky-title-column",start:"top top+="+ (o.offsetHeight+40),end:()=>"+="+(document.querySelector(".scrollable-content-column").offsetHeight-document.querySelector(".sticky-title-column").offsetHeight-40),pinSpacing:"auto"});const v=document.querySelector(".horizontal-panels-wrapper");if(v&&v.children.length>0){const e=gsap.utils.toArray(".horizontal-panel",v),t=document.querySelector(".horizontal-scroll-container"),n=gsap.to(e,{xPercent:-100*(e.length-1),ease:"none",scrollTrigger:{trigger:t,pin:!0,scrub:1.2,snap:{snapTo:1/(e.length-1),duration:{min:.2,max:.6},ease:"power1.inOut"},end:()=>"+="+(v.offsetWidth-window.innerWidth)}});e.forEach(e=>{const t=e.querySelector(".panel-image");t&&gsap.fromTo(t,{backgroundPosition:"70% 50%"},{backgroundPosition:"30% 50%",ease:"none",scrollTrigger:{trigger:e,containerAnimation:n,start:"left right",end:"right left",scrub:!0}})})};const k=document.querySelectorAll(".accordion-minimal-item");k.forEach(e=>{const t=e.querySelector(".accordion-minimal-header"),o=e.querySelector(".accordion-minimal-content"),n=t.querySelector(".accordion-minimal-icon");t.addEventListener("click",()=>{const i=e.classList.toggle("active");t.setAttribute("aria-expanded",i),n&&n.setAttribute("icon",i?"mdi:minus":"mdi:plus"),gsap.to(o,{maxHeight:i?o.scrollHeight:0,paddingBottom:i?"var(--spacing-l)":0,duration:.5,ease:"power3.inOut"})})});const b=gsap.utils.toArray(".testimonial-slide-modern"),L=document.querySelector(".prev-testimonial-modern"),S=document.querySelector(".next-testimonial-modern");letC=0,w=!1;if(b.length>0){function x(e,t="next"){if(0===b.length||w)return;w=!0;const o=b[C],n=b[e];gsap.timeline({onComplete:()=>w=!1}).to(o,{autoAlpha:0,xPercent:"next"===t?-25:25,duration:.4,ease:"power2.in"}).set(o,{display:"none"}).set(n,{display:"block",autoAlpha:0,xPercent:"next"===t?25:-25,scale:.98}).to(n,{autoAlpha:1,xPercent:0,scale:1,duration:.55,ease:"power3.out"}),C=e,b.forEach(e=>e.classList.remove("active")),n.classList.add("active")}gsap.set(b,{display:"none",autoAlpha:0}),gsap.set(b[0],{display:"block",autoAlpha:1}),b[0].classList.add("active"),L&&S&&(S.addEventListener("click",()=>{let e=(C+1)%b.length;x(e,"next")}),L.addEventListener("click",()=>{let e=(C-1+b.length)%b.length;x(e,"prev")}))}const A=gsap.utils.toArray(".animate-on-scroll, .animate-sticky-title, .animate-scroll-item");A.forEach(e=>{const t=parseFloat(e.dataset.delay)||0;let o=50,n=0,i=1;e.classList.contains("animate-from-left")&&(n=-50,o=0),e.classList.contains("animate-from-right")&&(n=50,o=0),e.classList.contains("animate-scale-in")&&(i=.9),gsap.fromTo(e,{autoAlpha:0,y:o,x:n,scale:i},{autoAlpha:1,y:0,x:0,scale:1,duration:1,delay:t,scrollTrigger:{trigger:e,start:"top 88%",toggleActions:"play none none none"},ease:"power3.out"})}),document.querySelectorAll("#current-year-footer, #current-year-mobile").forEach(e=>{e&&(e.textContent=(new Date).getFullYear())}),ScrollTrigger.refresh()});